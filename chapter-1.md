# Chapter 1. Getting Started

## Architectural Fundamentals

- PostgreSQL ใช้ 2 โมเดลคือ client / server
- Session ของ PostgreSQL ประกอบด้วย 2 กระบวนการ ที่ทำงานร่วมกันดังต่อไปนี้:
  - server process กระบวนการเซิร์ฟเวอร์ซึ่งจัดการไฟล์ฐานข้อมูล จะรับการเชื่อมต่อกับฐานข้อมูลจากแอปพลิเคชัน (client) และดำเนินการต่างๆ ในฐานข้อมูลในนามของ client โปรแกรมฐานข้อมูลฝั่ง server นี้เรียกว่า postgres
  - The user's client (frontend) application ที่ต้องการดำเนินการกับฐานข้อมูล แอปพลิเคชันไคลเอ็นต์นั้นมีความหลากหลายมาก เช่น อาจเป็นเครื่องมือที่เน้นข้อความ, แอปพลิเคชันแบบกราฟิก, เว็บเซิร์ฟเวอร์ที่เข้าถึงฐานข้อมูลเพื่อแสดงหน้าเว็บ, หรือเครื่องมือบำรุงรักษาฐานข้อมูลเฉพาะทาง แอปพลิเคชันไคลเอ็นต์บางส่วนมีให้มาพร้อมกับ PostgreSQL แต่ส่วนใหญ่พัฒนาโดยผู้ใช้เอง

- โดยทั่วไปแล้ว client / server นั้นสามารถอยู่บนโฮสต์ที่แตกต่างกันได้ ในกรณีนี้จะสื่อสารกันผ่านการเชื่อมต่อเครือข่าย TCP/IP

## Installation

`docker run -d --rm --name pg -p 5432:5432 --user postgres -e POSTGRES_PASSWORD=123qwe postgres`

## Creating a database

- ทดสอบเพื่อดูว่า สามารถเข้าถึงเซิร์ฟเวอร์ฐานข้อมูลได้หรือไม่ ลองสร้างฐานข้อมูล
  - `createdb exat || createdb -U postgres exat`[^1] [^2]
    - createdb คือคำสั่งในรูปแบบ Command Line Utility ของ PostgreSQL ที่ใช้สำหรับสร้างฐานข้อมูลใหม่ได้อย่างรวดเร็วผ่าน Terminal หรือ Command Prompt โดยเป็น Wrapper (ตัวครอบ) ของคำสั่ง SQL CREATE DATABASE ทำให้สร้างฐานข้อมูล, กำหนดเจ้าของ (-O), หรือกำหนด Encoding ได้โดยตรงโดยไม่ต้องเข้าใช้งานผ่าน psql
    - วิธีดู Utility ของ PostgreSQL มีอะไรบ้าง ให้ใช้คำสั่ง `ls -l /usr/bin | grep "pg_wrapper"`
  - `dropdb exat || dropdb -U postgres exat`[^1]
  - PostgreSQL สามารถจัดการฐานข้อมูลได้มากกว่า 1 แต่โดยทั่วไปแล้ว จะใช้ฐานข้อมูลแยกกัน ในแต่ละโปรเจค หรือแต่หละ user

## Accessing a Database

- เมื่อคุณสร้างฐานข้อมูลเสร็จแล้ว สามารถเข้าถึงได้โดยวิธีดังต่อไปนี้
  - PostgreSQL interactive terminal program เรียกว่า psql ซึ่งช่วยให้สามารถป้อน แก้ไข และเรียกใช้คำสั่ง SQL
  - สามารถเปิดใช้งานฐานข้อมูล exat ได้โดยพิมพ์คำสั่ง `psql exat || psql -U postgres exat`[^1]
  - สิ่งที่จะเห็นคือ `exat=>`[^3]
    - `select version();`
    - `select current_date;`
    - `select 2+2;`
    - `\h` แสดงคำสั่ง sql ต่างๆ
    - `\q` ออกจาก psql

### Footnotes

[^1]:
    Default Convention ที่ออกแบบมาเพื่อความสะดวกและการรักษาความปลอดภัย โดยหากคุณเชื่อมต่อผ่าน Terminal โดยไม่ได้ระบุ User ทาง PostgreSQL จะพยายามใช้ User ของ OS นั้นโดยอัตโนมัติ เพื่อให้เริ่มทำงานได้ทันที

    - เหตุผลหลักและแนวทางปฏิบัติ:
      - ค่าเริ่มต้น (Default Behavior): เมื่อสั่ง Command Line Utility โดยไม่ระบุ User ระบบจะใช้ชื่อ OS User ปัจจุบัน
      - ความปลอดภัย: ช่วยป้องกันการเข้าถึงฐานข้อมูลอื่นโดยไม่ได้ตั้งใจ โดยให้สิทธิ์ผู้ใช้เข้าถึงเฉพาะพื้นที่ข้อมูลที่กำหนดไว้
      - ความสะดวก: ผู้ใช้งานไม่ต้องพิมพ์ระบุชื่อฐานข้อมูลทุกครั้งในการเชื่อมต่อ
      - โครงสร้าง: ช่วยจัดระเบียบฐานข้อมูลที่เชื่อมโยงกับผู้ใช้งานเฉพาะคน อย่างไรก็ตาม ผู้ใช้สามารถสร้าง User และ Database ที่ชื่อต่างกันได้ และกำหนดสิทธิ์ (Grant) ให้เข้าถึงกันได้ตามต้องการ

[^2]: หากไม่ต้องการใส่ User บ่อยๆ ให้ใช้คำสั่ง `export PGUSER=postgres`

[^3]: หากเป็น `exat=#` นั่นหมายความว่า คุณเป็นผู้ใช้ระดับสูงสุดของฐานข้อมูล ซึ่งเป็นไปได้หากคุณติดตั้งอินสแตนซ์ PostgreSQL ด้วยตนเอง การเป็นผู้ใช้ระดับสูงสุด หมายความว่าคุณจะไม่ถูกจำกัดการเข้าถึง
